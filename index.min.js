!function(){"use strict";var e,t,n,a,o,r=$("#form-body"),s=$("#data-body"),l=["1.0PDX_ID-NanoStringLabels_JCA.json","1.0PDX_ID-SN-Affy-IllumID_JCAv2.json","2.0PDXID_MTDrugRespD7_JCA.json","2.0PDXID_MTDrugRespD14_JCA.json","2.0PDXID_SphDrugRespD7_JCA.json","PDX Summary Table CDW.json","radiation response data.json","TMZ response data.json","Xenograft summary 011119 GYG_other.json","Xenograft summary 011119 GYG.json","IC Survival Data.json"];t=function(e){return new Promise(function(t,n){$.ajax({dataType:"text",url:e,success:t,error:function(t){console.warn(t),n("Failed to get: "+e)}})})},o=function(){var e,t,n,a,o,r,l,c;return t=function(e,t){console.log(t),s.empty(),s.append($("<p>",{class:"h4",text:e})),s.append(o(t))},l=function(e,t,n){var a=n>1?" entries)":" entry)";return $("<div>",{class:"card-header",id:"heading"+t}).append($("<h2>",{class:"mb-0"}).append($("<button>",{class:"btn btn-link collapsed",type:"button","data-toggle":"collapse","data-target":"#collapse"+t,"aria-expanded":"false","aria-controls":"collapse"+t,html:e+" ("+n+a})))},e=function(e){var t,n="";for(n+='<p class="h5">'+e.pdx_id+": "+e.entry_name+'</p><p class="font-weight-light text-muted">'+e.description+"<br />-"+e.entry_metadata.user+'</p><p><ul class="list-group">',t=0;t<e.entry_data.length;t+=1)n+='<li class="list-group-item"><strong>'+e.entry_data[t].key+":</strong> &emsp; "+e.entry_data[t].value+"</li>";return n+="</ul></p><hr />",$(n)},c=function(t,n){var a,o,r;for(a=$("<div>",{id:"collapse"+n,class:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionHolder"}),o=$("<div>",{class:"card-body"}),r=0;r<t.length;r+=1)o.append(e(t[r]));return console.log("in entry builder body",t),a.append(o),a},o=function(e){var t,a,o,r,s;for(a=n(e),t=Object.keys(a),r=$("<div>",{class:"accordion",style:"margin-bottom: 10px;",id:"accordionHolder"}),o=0;o<t.length;o+=1)s=Math.random().toString().replace(/^0\./,""),r.append($("<div>",{class:"card"}).append(l(t[o],s,a[t[o]].length)).append(c(a[t[o]],s)));return r},r=function(e,t){return a(t)-a(e)},a=function(e){var t,n,a=-1/0;for(t=0;t<e.entry_data.length;t+=1)e.entry_data[t].value.match(/\d{1,2}\/\d{1,2}\/\d{1,2}/)&&(n=Date.parse(e.entry_data[t].value))&&(a=Math.max(n,a));return a},n=function(e){var t=0,n={},a=[];for(t=0;t<e.length;t+=1)n[e[t].entry_name]=n[e[t].entry_name]||[],n[e[t].entry_name].push(e[t]),a.push(e[t].entry_name);for(t=0;t<a.length;t+=1)n[a[t]]=n[a[t]].sort(r);return n},t}(),e=function(){var e,t,n,a;return a=new RegExp("[^A-Za-z0-9]+","i"),t=function(e,t){return!(!e||""===e)&&n.indexOf(e)===t},e=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n=(n=n.concat(e[t].key.split(a))).concat(e[t].value.split(a));return n},function(o){var r,s,l,c,i={};for(c=["description","entry_data","entry_metadata","entry_name","historical","origin_id","pdx_id"],r=0;r<o.length;r+=1)for(n=[],Object.defineProperty(o[r],"search_temp_key",{value:Math.random().toString().replace(/0\./,""),writable:!1,enumerable:!1,configurable:!1}),n=n.concat(o[r][c[0]].split(a)),n=n.concat(o[r][c[3]].split(a)),n=n.concat([o[r][c[4]]]),n=n.concat([o[r][c[5]]]),n=n.concat(o[r][c[4]].split(a)),n=n.concat(o[r][c[5]].split(a)),n=n.concat(e(o[r][c[1]])),n=n.concat(e(o[r][c[2]])),n=n.filter(t),s=0;s<n.length;s+=1)i[l=n[s].toLocaleLowerCase()]=i[l]||[],i[l].push(o[r]);return i}}(),n=function(t){var n,s,l,c,i,p,u,d,f,h,m,y,g=a(t),b=Object.keys(g),_=e(t),v=!1;for(l=[],i=function(){v||(v=!0,setTimeout(d,1e3))},d=function(){v?(v=!1,setTimeout(d,1e3)):u(p.val())},u=function(e){var t,n,a,r,s=[],l={},c=0;for(f(),t=e.toLocaleLowerCase().split(/\s+/),n=0;n<t.length;n+=1)if(_.hasOwnProperty(t[n]))for(a=0;a<_[t[n]].length;a+=1)s.push(_[t[n]][a]),l[_[t[n]][a].search_temp_key]=l[_[t[n]][a].search_temp_key]||[0,_[t[n]][a]],l[_[t[n]][a].search_temp_key][0]+=1,c=Math.max(l[_[t[n]][a].search_temp_key][0],c);if(c>1)for(s=[],r=Object.keys(l),n=0;n<r.length;n+=1)l[r[n]][0]>=c&&s.push(l[r[n]][1]);o("Search: '"+e+"'",s),console.log(s)},f=function(){var e;for(e=0;e<l.length;e+=1)l[e].select[0][0].selected=!0},h=function(){p.val("")},c=function(e){var t,n;for(e.preventDefault(),h(),t=this.value.split(";").map(function(e){return 1*e}),console.log(t),console.log(l),n=0;n<l.length;n+=1)n!==t[0]&&(console.log(n,t[0]),l[n].select[0][0].selected=!0);o(l[t[0]].option_keys[t[1]],g[b[t[0]]][l[t[0]].option_keys[t[1]]])},m=0;m<b.length;m+=1){for(s=$("<select>",{class:"form-control",id:"select headers"+m}),r.append($("<div>",{class:"form-group col-3"}).append($("<label>",{for:"select headers"+m,text:b[m]})).append(s)),n=Object.keys(g[b[m]]),$("<option>",{text:"Select one...",disabled:"disabled",selected:"selected"}).appendTo(s),l[m]={select:s,option_keys:JSON.parse(JSON.stringify(n)),options:[]},y=0;y<n.length;y+=1)l[m].options[y]=$("<option>",{text:n[y],val:m+";"+y}).appendTo(s);s.on("change",c)}console.log(_),p=$("<input>",{type:"text",style:"height: 100%",class:"form-control","aria-label":"Default","aria-describedby":"searchBarInuput439201432"}).on("keyup",i),$("<div>",{class:"input-group mb-3 col-6"}).append($("<div>",{class:"input-group-prepend"}).append($("<span>",{class:"input-group-text",id:"searchBarInuput439201432",html:"Exact Word Search"}))).append(p).appendTo(r)},a=function(e){var t,n={pdx_id:{},origin_id:{}},a=Object.keys(n);return e.map(function(e){for(t=0;t<a.length;t+=1)e.hasOwnProperty(a[t])&&(n[a[t]]=n[a[t]]||{},n[a[t]][e[a[t]]]=n[a[t]][e[a[t]]]||[],n[a[t]][e[a[t]]].push(e))}),n},function(){var e=$("#data-request-body");new Promise(function(n,a){e.append($("<div>",{class:"form-body"}).append($("<form>",{class:"form-signin",html:'<h1 class="h3 mb-3 font-weight-normal">Please Enter Passphrase</h1><label for="inputEmail" class="sr-only">Email address</label><input type="password" id="inputName" class="form-control" placeholder="passphrapse" required autofocus>'}).append($("<button>",{class:"btn btn-lg btn-primary btn-block",type:"submit",text:"Submit",click:function(e){e.preventDefault();var o=e.target.form[0].value;t("http://138.26.31.155:8000/uabfile/"+o+"/key.uuid").then(function(e){n(o+"/"+e+"/")}).catch(function(e){a(e)})}}))))}).then(function(a){e.empty().hide(),Promise.all(l.map(function(e){return"http://138.26.31.155:8000/uabfile/"+a+e}).map(t)).then(function(e){e=e.map(function(e){return e.split("\n").map(function(e){return JSON.parse(e)})}).reduce(function(e,t){return e.concat(t)}),n(e)}).catch(function(e){console.warn(e)})}).catch(function(){e.empty().html("Incorrect, please reload and try again if you believe this is in error.")})}()}();
