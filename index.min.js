!function(){"use strict";var e,n,t,a,o=$("#form-body"),r=$("#data-body"),s=["1.0PDX_ID-NanoStringLabels_JCA.json","1.0PDX_ID-SN-Affy-IllumID_JCAv2.json","2.0PDXID_MTDrugRespD7_JCA.json","2.0PDXID_MTDrugRespD14_JCA.json","2.0PDXID_SphDrugRespD7_JCA.json","PDX Summary Table CDW.json","radiation response data.json","TMZ response data.json","Xenograft summary 011119 GYG_other.json","Xenograft summary 011119 GYG.json","IC Survival Data.json"];e=function(e){return new Promise(function(n,t){$.ajax({dataType:"text",url:e,success:n,error:function(n){console.warn(n),t("Failed to get: "+e)}})})},a=function(){var e,n,t,a,o,s,l,i;return n=function(e,n){console.log(n),r.empty(),r.append($("<p>",{class:"h4",text:e})),r.append(o(n))},l=function(e,n,t){var a=t>1?" entries)":" entry)";return $("<div>",{class:"card-header",id:"heading"+n}).append($("<h2>",{class:"mb-0"}).append($("<button>",{class:"btn btn-link collapsed",type:"button","data-toggle":"collapse","data-target":"#collapse"+n,"aria-expanded":"false","aria-controls":"collapse"+n,html:e+" ("+t+a})))},e=function(e){var n,t="";for(t+='<p class="h5">'+e.pdx_id+": "+e.entry_name+'</p><p class="font-weight-light text-muted">'+e.description+"<br />-"+e.entry_metadata.user+'</p><p><ul class="list-group">',n=0;n<e.entry_data.length;n+=1)t+='<li class="list-group-item"><strong>'+e.entry_data[n].key+":</strong> &emsp; "+e.entry_data[n].value+"</li>";return t+="</ul></p><hr />",$(t)},i=function(n,t){var a,o,r;for(a=$("<div>",{id:"collapse"+t,class:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionHolder"}),o=$("<div>",{class:"card-body"}),r=0;r<n.length;r+=1)o.append(e(n[r]));return console.log("in entry builder body",n),a.append(o),a},o=function(e){var n,a,o,r,s;for(a=t(e),n=Object.keys(a),r=$("<div>",{class:"accordion",style:"margin-bottom: 10px;",id:"accordionHolder"}),o=0;o<n.length;o+=1)s=Math.random().toString().replace(/^0\./,""),r.append($("<div>",{class:"card"}).append(l(n[o],s,a[n[o]].length)).append(i(a[n[o]],s)));return r},s=function(e,n){return a(n)-a(e)},a=function(e){var n,t,a=-1/0;for(n=0;n<e.entry_data.length;n+=1)e.entry_data[n].value.match(/\d{1,2}\/\d{1,2}\/\d{1,2}/)&&(t=Date.parse(e.entry_data[n].value))&&(a=Math.max(t,a));return a},t=function(e){var n=0,t={},a=[];for(n=0;n<e.length;n+=1)t[e[n].entry_name]=t[e[n].entry_name]||[],t[e[n].entry_name].push(e[n]),a.push(e[n].entry_name);for(n=0;n<a.length;n+=1)t[a[n]]=t[a[n]].sort(s);return t},n}(),n=function(e){var n,r,s,l,i,c,p=t(e),d=Object.keys(p);for(s=[],l=function(e){var n,t;for(e.preventDefault(),n=this.value.split(";").map(function(e){return 1*e}),console.log(n),console.log(s),t=0;t<s.length;t+=1)t!==n[0]&&(console.log(t,n[0]),s[t].select[0][0].selected=!0);a(s[n[0]].option_keys[n[1]],p[d[n[0]]][s[n[0]].option_keys[n[1]]])},i=0;i<d.length;i+=1){for(r=$("<select>",{class:"form-control",id:"select headers"+i}),o.append($("<div>",{class:"form-group"}).append($("<label>",{for:"select headers"+i,text:d[i]})).append(r)),n=Object.keys(p[d[i]]),$("<option>",{text:"Select one...",disabled:"disabled",selected:"selected"}).appendTo(r),s[i]={select:r,option_keys:JSON.parse(JSON.stringify(n)),options:[]},c=0;c<n.length;c+=1)s[i].options[c]=$("<option>",{text:n[c],val:i+";"+c}).appendTo(r);r.on("change",l)}},t=function(e){var n,t={pdx_id:{},origin_id:{}},a=Object.keys(t);return e.map(function(e){for(n=0;n<a.length;n+=1)e.hasOwnProperty(a[n])&&(t[a[n]]=t[a[n]]||{},t[a[n]][e[a[n]]]=t[a[n]][e[a[n]]]||[],t[a[n]][e[a[n]]].push(e))}),t},function(){var t=$("#data-request-body");new Promise(function(n,a){t.append($("<div>",{class:"form-body"}).append($("<form>",{class:"form-signin",html:'<h1 class="h3 mb-3 font-weight-normal">Please Enter Passphrase</h1><label for="inputEmail" class="sr-only">Email address</label><input type="password" id="inputName" class="form-control" placeholder="passphrapse" required autofocus>'}).append($("<button>",{class:"btn btn-lg btn-primary btn-block",type:"submit",text:"Submit",click:function(t){t.preventDefault();var o=t.target.form[0].value;e("http://138.26.31.155:8000/uabfile/"+o+"/key.uuid").then(function(e){n(o+"/"+e+"/")}).catch(function(e){a(e)})}}))))}).then(function(a){t.empty().hide(),Promise.all(s.map(function(e){return"http://138.26.31.155:8000/uabfile/"+a+e}).map(e)).then(function(e){e=e.map(function(e){return e.split("\n").map(function(e){return JSON.parse(e)})}).reduce(function(e,n){return e.concat(n)}),n(e)}).catch(function(e){console.warn(e)})}).catch(function(){t.empty().html("Incorrect, please reload and try again if you believe this is in error.")})}()}();
